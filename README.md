# CSV â†’ Postgres loader

Simple script to load a CSV file into a Postgres table.

Usage example:

```bash
python3 load_csv_to_pg.py --host localhost --port 5432 --dbname mydb \
  --user myuser --password secret --csv data.csv --table data
```

Install dependencies:

```bash
python3 -m pip install -r requirements.txt
```

The script will create the target table (all columns as text) if it doesn't exist and then INSERT the CSV data into it.

## Notes

This script was primarily generated by Github Copilot. 

I refined the script a few times using different prompts because initially, the script did not do a good job of handling CSV files with fields that have line breaks. It used the cursor.copy_export() method from psycopg2, which uses the SQL COPY statement to load file-like objects into PG, presumably more efficiently than INSERTs. The COPY statement is supposed to support fields with line breaks but the original script kept throwing errors. 

I prompted Copilot to use the native Python csv module to parse the csv into an object, then use the INSERT statement to write the record to PG. This change made the script work.

